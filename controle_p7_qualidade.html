<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Portaria 07 - Controle de Ve√≠culos - Qualidade</title>
<script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/exceljs/dist/exceljs.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/file-saver/dist/FileSaver.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet"/>
<style>
:root { --cor-fundo:#0b1d30; --cor-caixa:#1c2b3d; --cor-primaria:#00d2ff; --cor-hover:#1a4ed8; --cor-texto:#ffffff; --cor-alerta:#f0ad4e; --cor-erro:#ff4444; }
* { box-sizing: border-box; }
body { margin: 0; padding: 1rem; font-family: 'Orbitron', sans-serif; background-color: var(--cor-fundo); background-image: radial-gradient(circle at top left, #1b2735, #090a0f); color: var(--cor-texto); }
.container { max-width: 920px; margin: auto; background: rgba(28,43,61,0.6); backdrop-filter: blur(15px); border: 1px solid rgba(0,212,255,0.15); padding: 2rem; border-radius: 20px; box-shadow: 0 0 30px rgba(0,255,255,0.15), inset 0 0 10px rgba(0,255,255,0.05); display:flex; flex-direction:column; gap:1.5rem; animation: fadeIn 0.6s ease-in-out; }
h1 { font-size:1.8rem; letter-spacing:6px; background:linear-gradient(90deg,var(--cor-primaria),#3a7bd5); -webkit-background-clip:text; -webkit-text-fill-color:transparent; font-weight:800; font-family:'Orbitron',sans-serif; text-shadow:0 0 10px rgba(0,210,255,0.5); margin-bottom:.5rem; text-align:center; }
h2 { font-size:1.2rem; font-weight:600; letter-spacing:2px; text-transform:uppercase; color:var(--cor-primaria); opacity:.85; margin-bottom:1.5rem; font-family:'Orbitron',sans-serif; text-align:center; }
h3 { font-size:1rem; font-weight:500; letter-spacing:1px; color:var(--cor-primaria); opacity:.85; margin-bottom:1rem; text-align:center; }
label { font-weight:600; font-size:.95rem; display:flex; flex-direction:column; margin-top:.5rem; font-family:Arial,sans-serif; position:relative; }
input, textarea, select { margin-top:.4rem; padding:.7rem; border:1px solid #00d2ff44; border-radius:12px; font-size:1rem; background:rgba(0,0,0,0.35); color:#fff; backdrop-filter:blur(4px); box-shadow: inset 0 0 8px rgba(0,210,255,0.1); transition:all .2s; font-family:Arial,sans-serif; }
textarea { min-height: 72px; resize: vertical; }
#numeroChassi { padding-right: 108px; }
#chassiConfirmIcon { display:none; position:absolute; right:-32px; top:14px; width:90px; height:90px; font-size:4.5rem; color:#35ff5a; z-index:10; pointer-events:none; background:rgba(255,255,255,0.78); border-radius:50%; box-shadow:0 0 35px 14px #26e76e99, 0 0 0 6px #57ffa755; transition:opacity 0.25s, transform 0.17s; opacity:0; transform:scale(0.7); display:flex; align-items:center; justify-content:center; }
#chassiConfirmIcon.visible { display:flex; opacity:1; transform:scale(1.16); animation:confirmpop 0.34s cubic-bezier(.68,-0.55,.27,1.55); }
@keyframes confirmpop { 0%{opacity:0; transform:scale(.5);} 60%{opacity:1; transform:scale(1.32);} 85%{transform:scale(1);} 100%{transform:scale(1.16);} }
button { background:linear-gradient(135deg,#3a7bd5,var(--cor-primaria)); color:#fff; border:1px solid var(--cor-primaria); padding:.75rem 1.5rem; border-radius:14px; font-size:1rem; font-weight:600; display:inline-flex; align-items:center; gap:.5rem; cursor:pointer; box-shadow:0 0 6px var(--cor-primaria)66, 0 0 10px var(--cor-primaria)33; transition:all .3s; font-family:'Orbitron',sans-serif; }
button:hover { background:linear-gradient(135deg,var(--cor-primaria),#3a7bd5); box-shadow:0 0 20px rgba(0,210,255,.85); transform:scale(1.05); }
.button-group { display:flex; flex-wrap:wrap; justify-content:center; gap:.75rem; }
.auto-save-icon { text-align:right; font-size:.85rem; color:#55dd55; font-family:Arial,sans-serif; }
.info { font-weight:bold; text-align:center; color:var(--cor-alerta); font-family:Arial,sans-serif; }
#tabelaContainer { display:none; }
table { width:100%; border-collapse:collapse; margin-top:1rem; font-size:.95rem; font-family:Arial,sans-serif; }
th, td { border:1px solid #2e3c51; padding:.6rem; text-align:center; color:#fff; }
th { background:#233246; color:var(--cor-primaria); }
@media(max-width:600px){ .container{padding:1rem;} .button-group{flex-direction:column;} button{width:100%; justify-content:center;} .auto-save-icon{text-align:center;margin-top:.5rem;} }
@keyframes fadeIn { from{opacity:0; transform:translateY(15px);} to{opacity:1; transform:translateY(0);} }
#botoesInternos { display:none; flex-direction:column; gap:.75rem; justify-content:center; margin-bottom:1rem; }

/* ===== Melhoria Visual: Campos bloqueados + tooltip + contraste ===== */
:root{
  --locked-badge-bg: rgba(255,255,255,.06);
  --locked-badge-br: 1px solid #ffffff22;
  --tooltip-bg: rgba(0,0,0,.85);
  --tooltip-br: 1px solid #ffffff22;
}

/* Contraste mais claro para campos edit√°veis */
input:not([readonly]), select:not([disabled]), textarea:not([readonly]){
  border-color: #00d2ff66 !important;
  box-shadow: 0 0 0 1px #00d2ff22 inset;
}

/* Apar√™ncia consistente para bloqueados (somente leitura) */
input[readonly], textarea[readonly]{
  cursor: not-allowed !important;
  opacity: .65;
  filter: saturate(85%);
  box-shadow: inset 0 0 0 1px #ffffff22 !important;
}

/* Badge e √≠cone de cadeado posicionados dentro do label */
.lock-indicator{
  position: absolute;
  right: .6rem;
  top: .2rem;
  display: inline-flex;
  align-items: center;
  gap: .35rem;
  font-size: .72rem;
  letter-spacing: .06em;
  text-transform: uppercase;
  opacity: .8;
  padding: .18rem .45rem;
  background: var(--locked-badge-bg);
  border: var(--locked-badge-br);
  border-radius: 8px;
  user-select: none;
  pointer-events: none;
}

/* Tooltip estilizado */
.has-tooltip{
  position: relative;
}
.has-tooltip::after{
  content: attr(data-tooltip);
  position: absolute;
  left: 0;
  top: calc(100% + .35rem);
  white-space: nowrap;
  background: var(--tooltip-bg);
  color: #fff;
  font-size: .8rem;
  padding: .35rem .55rem;
  border-radius: 8px;
  border: var(--tooltip-br);
  opacity: 0;
  transform: translateY(-3px);
  transition: opacity .18s ease, transform .18s ease;
  pointer-events: none;
  z-index: 30;
}
.has-tooltip:hover::after,
.has-tooltip:focus-within::after{
  opacity: 1;
  transform: translateY(0);
}

</style>

<style id="patch-info-green-css">

/* === PATCH: valor do chassi em verde, somente o valor === */
.info { color: #ffffff !important; } /* mant√©m t√≠tulo em amarelo */
.info .info-value {
  color: #00ff99 !important;
  text-shadow: 0 0 10px rgba(0, 255, 153, 0.9), 0 0 20px rgba(0, 255, 153, 0.7) !important;
  font-weight: 800 !important;
}
.info:empty { display: none !important; }

</style>

<style id="patch-header-compact">
  /* Compacta o cabe√ßalho sem mudar o visual */
  h1 { margin: 0 0 .25rem !important; line-height: 1.05 !important; letter-spacing: 4px !important; }
  h2 { margin: .1rem 0 .35rem !important; line-height: 1.05 !important; }
  h3 { margin: .1rem 0 .5rem  !important; line-height: 1.05 !important; }
  /* Se existir container com gap (algumas telas), reduz um pouco */
  .container { gap: .75rem !important; }
</style>







<style id="compact-header-v4">
h1 { margin: 0 !important; padding: 0 !important; line-height: 1 !important; }
h1 img { max-width: 260px; height: auto; display: block; margin: 0 auto; }

h2 { font-size: 1rem !important; margin: 0 !important; line-height: 1.05 !important; }
h3 { font-size: 1.4rem !important; margin: .1rem 0 .25rem !important; line-height: 1.1 !important; }

.header { text-align: center; margin: 0 !important; padding: 0 !important; }
</style>

</head>
<body>
<div class="container">
<h1><img src="logo_stellantis.png" alt="Stellantis" style="max-width:180px; height:auto; display:block; margin:0 auto;"></h1>
<h2>Seguran√ßa Patrimonial</h2>
<h3>Controle de Ve√≠culos - Qualidade</h3>
<label>Setor:
  <input id="setor" type="text" value="Portaria 07" readonly tabindex="-1" inputmode="none"/>
</label>
<label>Turno:
  <input id="turno" readonly tabindex="-1" inputmode="none"/>
</label>
<label style="position: relative;">
  N√∫mero de chassi:
  <input id="numeroChassi" type="text" autocomplete="off" autofocus style="padding-right:108px;">
  <span id="chassiConfirmIcon"><i data-feather="check-circle"></i></span>
</label>
<label>Observa√ß√£o:
  <textarea id="observacao" placeholder="Digite alguma observa√ß√£o (opcional)"></textarea>
</label>
<label>Controlador de acesso:
  <input id="controladorAcesso" type="text" readonly tabindex="-1" inputmode="none"/>
</label>
<div id="info" class="info" aria-live="polite"></div>
<div class="auto-save-icon">üíæ Salvamento autom√°tico</div>
<div class="button-group">
  <button id="btnOutrasInfos" onclick="acessarOutrasInfos()"><i data-feather="menu"></i>Outras informa√ß√µes</button>
  <button id="btnToggleTabela" onclick="toggleTabela()"><i data-feather="eye"></i>Visualizar Tabela</button>
  <button onclick="sair()"><i data-feather="log-out"></i>Sair</button>
</div>
<div id="botoesInternos" class="button-group">
  <button id="btnAdicionar" onclick="adicionarItem()"><i data-feather="plus-circle"></i>Adicionar</button>
  <button id="btnDesfazer" onclick="desfazerUltimo()"><i data-feather="rotate-ccw"></i>Desfazer</button>
  <button id="btnEditarSenha" onclick="editarSenha()"><i data-feather="key"></i>Editar senha</button>
  <button id="btnFecharBotoesInternos" onclick="ocultarBotoesInternos()"><i data-feather="x"></i>Fechar</button>
</div>
<div id="totalVeiculos" style="font-weight:bold; color:#00d2ff; text-align:center; font-size:1.7rem; margin-top:12px;">Total de ve√≠culos: 0</div>
<div id="tabelaContainer">
<table id="tabelaQualidade">
<thead>
<tr>
  <th>Setor</th><th>Turno</th><th>Controlador de acesso</th><th>N√∫mero de chassi</th><th>Observa√ß√£o</th><th>Data e Hora</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>
</div>
<!-- Modal Overlay -->
<div class="modal-overlay" id="modalOverlay" style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,.5); display:none; align-items:center; justify-content:center; z-index:10000;">
  <div class="modal-container" style="background: var(--cor-caixa); padding: 1.5rem; border-radius: 8px; width: 90%; max-width: 400px; box-shadow: 0 0 10px rgba(0,0,0,0.3);">
    <div id="modalHeader" class="modal-header" style="font-size: 1.25rem; font-weight: 700; margin-bottom: 0.5rem; color: var(--cor-primaria);"></div>
    <div id="modalBody" class="modal-body" style="margin-bottom: 1rem; color: #fff;"></div>
    <div id="modalFooter" class="modal-footer" style="display:flex; justify-content:flex-end; gap:.5rem;">
      <button id="modalCancel" class="btn-modal btn-secondary" style="padding:.5rem 1rem; border: none; border-radius: 4px; font-weight: 600; cursor: pointer; background: #FFA726; color: #fff;">Cancelar</button>
      <button id="modalConfirm" class="btn-modal btn-primary" style="padding:.5rem 1rem; border: none; border-radius: 4px; font-weight: 600; cursor: pointer; background: #00d2ff; color: #000;">OK</button>
    </div>
  </div>
</div>
<script>
  const storageKey = 'tabelaQualidade';
</script>
<script>
async function showModal(message){return new Promise(resolve=>{document.getElementById('modalHeader').textContent='';document.getElementById('modalBody').textContent=message;document.getElementById('modalCancel').style.display='none';document.getElementById('modalConfirm').textContent='OK';document.getElementById('modalConfirm').onclick=()=>{document.getElementById('modalOverlay').style.display='none';resolve();};document.getElementById('modalOverlay').style.display='flex';});}
async function showConfirm(message){return new Promise(resolve=>{document.getElementById('modalHeader').textContent='Confirma√ß√£o';document.getElementById('modalBody').textContent=message;document.getElementById('modalCancel').style.display='inline-block';document.getElementById('modalConfirm').textContent='Sim';document.getElementById('modalCancel').textContent='N√£o';document.getElementById('modalConfirm').onclick=()=>{document.getElementById('modalOverlay').style.display='none';resolve(true);};document.getElementById('modalCancel').onclick=()=>{document.getElementById('modalOverlay').style.display='none';resolve(false);};document.getElementById('modalOverlay').style.display='flex';});}
async function showPrompt(message){return new Promise(resolve=>{document.getElementById('modalHeader').textContent='Entrada de dados';const body=document.getElementById('modalBody');body.innerHTML=`<p>${message}</p><input type="text" id="modalInput" style="width:100%; padding:.5rem; margin-top:.5rem; border-radius:4px; border:1px solid #ccc;">`;document.getElementById('modalCancel').style.display='inline-block';document.getElementById('modalConfirm').textContent='OK';document.getElementById('modalConfirm').onclick=()=>{const val=document.getElementById('modalInput').value;document.getElementById('modalOverlay').style.display='none';resolve(val);};document.getElementById('modalCancel').onclick=()=>{document.getElementById('modalOverlay').style.display='none';resolve(null);};document.getElementById('modalOverlay').style.display='flex';});}
</script>
<script>
let senhaOutrasInfos = localStorage.getItem('senhaOutrasInfos') || '1234';
let tabelaDados = [];
function atualizarTotal(){ var el=document.getElementById("totalVeiculos"); if (el) el.textContent = "Total de ve√≠culos: " + tabelaDados.length; }
document.addEventListener("DOMContentLoaded", async () => {
  const _setorEl = document.getElementById("setor"); if(_setorEl){ _setorEl.value = "Portaria 07"; }


  // ===== Melhoria Visual: aplicar cadeado, badge e tooltip nos campos bloqueados =====
  function enhanceLockedField(inputEl, tooltipText){
    if(!inputEl) return;
    // garantir classe de tooltip no label
    const label = inputEl.closest('label');
    if(label){
      label.style.position = 'relative';
      label.classList.add('has-tooltip');
      if(!label.getAttribute('data-tooltip')){
        label.setAttribute('data-tooltip', tooltipText || 'Definido no login');
      }
      // inserir indicador com √≠cone de cadeado
      if(!label.querySelector('.lock-indicator')){
        const badge = document.createElement('span');
        badge.className = 'lock-indicator';
        badge.innerHTML = '<i data-feather="lock"></i>';
        label.appendChild(badge);
      }
    }
  }
  // aplicar melhorias visuais nas entradas bloqueadas
  enhanceLockedField(document.getElementById('turno'), 'Definido no login');
  enhanceLockedField(document.getElementById('controladorAcesso'), 'Definido no login');
  enhanceLockedField(document.getElementById('setor'), 'Valor fixo da p√°gina');
  // Opcional: se existir "setor" readonly, apenas visual (n√£o altera regras de bloqueio)
  (function(){
    const setor = document.getElementById('setor');
    if(setor && setor.hasAttribute('readonly')){
      enhanceLockedField(setor, 'Valor fixo da p√°gina');
    }
  })();
  // como adicionamos novos √≠cones dinamicamente, substituir feather novamente
  if (window.feather && typeof feather.replace === 'function') feather.replace();

  feather.replace();
  tabelaDados = JSON.parse(localStorage.getItem(storageKey)) || [];
  function salvarLocal(){ localStorage.setItem(storageKey, JSON.stringify(tabelaDados)); }
  function atualizarTabela(){
    atualizarTotal();
    const tbody = document.querySelector("#tabelaQualidade tbody");
    tbody.innerHTML = "";
    tabelaDados.slice().reverse().forEach(item => {
      const tr = document.createElement("tr");
      tr.innerHTML = `<td>${item.setor||""}</td><td>${item.turno||""}</td><td>${item.controlador||""}</td><td>${item.chassi||""}</td><td>${item.observacao||""}</td><td>${item.dataHora||""}</td>`;
      tbody.appendChild(tr);
    });
  }
  window.adicionarItem = async () => {
    atualizarTotal();
    const info = document.getElementById("info");
    const inputChassi = document.getElementById("numeroChassi");
    const inputObs    = document.getElementById("observacao");
    const iconConfirm = document.getElementById("chassiConfirmIcon");
    const chassi = inputChassi.value.trim();
    const controlador = document.getElementById("controladorAcesso").value.trim();
    const observacao = inputObs.value.trim();
    if (!chassi) { info.textContent = "Digite o n√∫mero de chassi."; inputChassi.focus(); return; }
    if (!controlador) { info.textContent = "Preencha o controlador de acesso."; document.getElementById("controladorAcesso").focus(); return; }
    
    // === BLOQUEIO DE DUPLICIDADE ===
    const norm = s => (s||"").replace(/\s+/g,'').toUpperCase();
    const existe = tabelaDados.some(item => norm(item.chassi) === norm(chassi));
    if (existe) {
      await showModal(`J√° existe o n√∫mero de chassi "${chassi}"`);
      info.textContent = `Chassi duplicado: ${chassi}`;
      if (typeof flashInvalid === 'function') flashInvalid(inputChassi);
      else { inputChassi.focus(); inputChassi.select?.(); }
      return;
    }
    // ===============================
tabelaDados.push({ setor: document.getElementById("setor").value, turno: document.getElementById("turno").value, controlador, chassi, observacao, dataHora: new Date().toLocaleString("pt-BR") });
    salvarLocal(); atualizarTabela(); inputChassi.value=""; inputObs.value=""; info.textContent = "Chassi adicionado - " + chassi;
    iconConfirm.classList.add("visible"); feather.replace(); setTimeout(()=>{ iconConfirm.classList.remove("visible"); }, 1500); inputChassi.focus();
  };
  document.getElementById("numeroChassi").addEventListener("keypress", e => { if (e.key === "Enter") window.adicionarItem(); });
  window.desfazerUltimo = async () => {
    atualizarTotal();
    const info = document.getElementById("info");
    if (!tabelaDados.length) { await showModal("Nada para desfazer."); return; }
    tabelaDados.pop(); salvarLocal(); atualizarTabela(); info.textContent = "√öltimo item removido.";
  };
  window.finalizarTurno = async () => {
    atualizarTotal();
    const info = document.getElementById("info");
    if (!tabelaDados.length) { await showModal("Nada para exportar."); return; }
    if (!await showConfirm("Deseja finalizar o turno e exportar a planilha?")) return;
    try {
      const ExcelJS = window.ExcelJS;
      const workbook = new ExcelJS.Workbook();
      const worksheet = workbook.addWorksheet("ControleChassi");
      worksheet.columns = [
        { header:'Setor', key:'setor', width:18 },
        { header:'Turno', key:'turno', width:12 },
        { header:'Controlador de acesso', key:'controlador', width:24 },
        { header:'N√∫mero de chassi', key:'chassi', width:22 },
        { header:'Observa√ß√£o', key:'observacao', width:28 },
        { header:'Data e Hora', key:'dataHora', width:22 }
      ];
      tabelaDados.slice().reverse().forEach(dado => worksheet.addRow(dado));
      worksheet.protect('1234', { selectLockedCells:true, selectUnlockedCells:false });
      worksheet.eachRow(row => { row.protection = { locked: true }; });
      const buffer = await workbook.xlsx.writeBuffer();
      const blob = new Blob([buffer], { type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" });
      const ts = new Date().toISOString().slice(0,19).replace(/[T:]/g,"_");
      saveAs(blob, `ControleChassi_Qualidade_${ts}.xlsx`);
      tabelaDados.length = 0; salvarLocal(); atualizarTabela();
      info.textContent = "Turno finalizado e planilha protegida gerada.";
    } catch (e) { info.textContent = "Erro ao gerar planilha."; }
  };
  window.toggleTabela = () => {
    const container = document.getElementById("tabelaContainer");
    const btn = document.getElementById("btnToggleTabela");
    const isHidden = !container.style.display || container.style.display === "none";
    container.style.display = isHidden ? "block" : "none";
    btn.innerHTML = isHidden ? '<i data-feather="eye-off"></i>Ocultar Tabela' : '<i data-feather="eye"></i>Visualizar Tabela';
    feather.replace();
  };
  // Restaura rascunhos
  document.getElementById('numeroChassi').value = localStorage.getItem('draftChassi') || '';
  document.getElementById('observacao').value = localStorage.getItem('draftObs') || '';
  document.getElementById('controladorAcesso').value = (localStorage.getItem("usuario")||"") + (localStorage.getItem("registro") ? " / "+localStorage.getItem("registro") : "");
  const turnoSalvo = localStorage.getItem('turno'); if (turnoSalvo) document.getElementById('turno').value = turnoSalvo;
  atualizarTabela(); ocultarBotoesInternos();
  if (tabelaDados.length) { await showModal('Dados restaurados.'); }
});
window.addEventListener('beforeunload', () => {
  localStorage.setItem('draftChassi', document.getElementById('numeroChassi').value);
  localStorage.setItem('draftObs', document.getElementById('observacao').value);
  localStorage.setItem('draftControlador', document.getElementById('controladorAcesso').value);
});
window.sair = async () => { if (await showConfirm("Tem certeza que deseja sair?")) { window.location.href = 'interface_principal.html'; } };
async function acessarOutrasInfos(){ const senha = await showPrompt('Digite a senha de 4 d√≠gitos:'); if (senha === senhaOutrasInfos) document.getElementById('botoesInternos').style.display='flex'; else { document.getElementById('botoesInternos').style.display='none'; await showModal('Senha incorreta.'); } }
function ocultarBotoesInternos(){ document.getElementById('botoesInternos').style.display='none'; }
async function editarSenha(){ const atual = await showPrompt('Digite a senha atual:'); if (atual !== senhaOutrasInfos) { await showModal('Senha incorreta!'); return; } const nova = await showPrompt('Digite a nova senha de 4 d√≠gitos:'); if (nova && nova.length===4 && /^\d+$/.test(nova)) { senhaOutrasInfos = nova; localStorage.setItem('senhaOutrasInfos', nova); await showModal('Senha alterada com sucesso!'); ocultarBotoesInternos(); } else { await showModal('Senha inv√°lida!'); } }
</script>
<script>feather.replace();</script>

<style id="patch-visual-inline-hidden">

/* === PATCH VISUAL INLINE (com info condicional) === */
#chassiConfirmIcon {
  position: absolute !important;
  right: -40px !important;   /* aparece ao lado direito do input */
  top: 50% !important;
  transform: translateY(-50%) !important;
  width: 60px !important;
  height: 60px !important;
  font-size: 2.5rem !important;
  color: #00ff99 !important;
  background: rgba(0,0,0,0.45) !important;
  border-radius: 50% !important;
  box-shadow: 0 0 20px #00ff99aa !important;
  overflow: hidden !important;
}
#chassiConfirmIcon::before,
#chassiConfirmIcon::after {
  content: "" !important;
  position: absolute !important;
  border: 2px solid #00ff99 !important;
  border-radius: 50% !important;
  animation: ripple 1.8s infinite !important;
}
#chassiConfirmIcon::before { width: 100% !important; height: 100% !important; }
#chassiConfirmIcon::after  { width: 130% !important; height: 130% !important; animation-delay: .9s !important; }

@keyframes ripple {
  from { transform: scale(0.6); opacity: 1; }
  to   { transform: scale(1.6); opacity: 0; }
}

/* Destaque do √∫ltimo chassi */
.info {
  font-weight: bold !important;
  text-align: center !important;
  color: #ffffff !important;        
  font-size: 2.2rem !important;     
  text-shadow: 0 0 10px rgba(255, 213, 79, 0.9),
               0 0 20px rgba(255, 213, 79, 0.7) !important; 
  background: rgba(0,0,0,0.45) !important;
  padding: 0.6rem 1rem !important;
  border-radius: 10px !important;
  display: inline-block !important;
  margin-top: 0.5rem !important;
}

/* Ocultar quando n√£o h√° n√∫mero de chassi */
.info:empty {
  display: none !important;
}

</style>

<script id="patch-info-value-green">
(function(){
  function wrapInfoValue(node){
    if(!node) return;
    // Evita reprocessar se j√° houver span
    if (node.querySelector && node.querySelector('.info-value')) return;
    var txt = (node.textContent || '').trim();
    if(!txt) { node.innerHTML=''; return; }
    // Caso padr√£o: "√öltimo chassi: ABC123" => mant√©m t√≠tulo e colore apenas o valor
    var idx = txt.lastIndexOf(':');
    if(idx !== -1 && idx < txt.length - 1){
      var titulo = txt.slice(0, idx + 1);
      var valor  = txt.slice(idx + 1).trim();
      node.innerHTML = titulo + ' <span class="info-value">' + valor + '</span>';
      return;
    }
    // Sem t√≠tulo com ":", tenta separar por espa√ßo; mant√©m primeiro token como t√≠tulo se pare√ßa com palavra
    var m = txt.match(/^(.*?)(\s+)([\w\-\.]+)$/);
    if(m){
      node.innerHTML = (m[1] || '') + m[2] + '<span class="info-value">' + (m[3] || '') + '</span>';
      return;
    }
    // Fallback: apenas n√∫meros em verde dentro do texto
    node.innerHTML = txt.replace(/(\d+)/g, '<span class="info-value">$1</span>');
  }

  function setupObserver(el){
    if(!el) return;
    // Observa mudan√ßas de texto para re-aplicar o wrap quando o app atualizar o conte√∫do
    var obs = new MutationObserver(function(){
      wrapInfoValue(el);
    });
    obs.observe(el, { childList: true, characterData: true, subtree: true });
    // Primeira aplica√ß√£o
    wrapInfoValue(el);
  }

  // Espera DOM e aplica em todos os elementos .info encontrados
  function init(){
    var infos = document.querySelectorAll('.info');
    infos.forEach(setupObserver);
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();
</script>

<script>
  function flashInvalid(el){
    el.classList.remove('shake');
    void el.offsetWidth;
    el.classList.add('input-error','shake');
    el.focus();
    if (el.select) el.select();
    const clear = ()=> el.classList.remove('input-error');
    el.addEventListener('input', clear, { once: true });
    setTimeout(()=> el.classList.remove('shake'), 450);
  }
</script>



</body>
</html>
